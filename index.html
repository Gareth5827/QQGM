<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Manufactured World</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #222;
            color: #eee;
            margin: 0;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            height: 100vh;
        }
        
        #TPContainer {
            position: absolute;
            top: 20px;
            right: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 5px;
        }
        
        .tp-controls {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        #TPCounter {
            font-size: 24px;
            padding: 10px;
            background-color: #333;
            border: 1px solid #555;
            border-radius: 5px;
            min-width: 50px;
            text-align: center;
        }
        
        .tp-button {
            width: 30px;
            height: 30px;
            font-size: 20px;
            background-color: #444;
            color: #eee;
            border: 1px solid #555;
            border-radius: 5px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .tp-button:hover {
            background-color: #555;
        }
        
        #TextBox {
            width: 80%;
            height: 70vh;
            margin-top: 60px;
            padding: 20px;
            background-color: #333;
            border: 1px solid #555;
            border-radius: 5px;
            overflow-y: auto;
            line-height: 1.6;
        }
        
        #InputField {
            width: 60%;
            padding: 15px;
            margin-top: 20px;
            font-size: 16px;
            background-color: #333;
            border: 1px solid #555;
            border-radius: 5px;
            color: #eee;
        }
        
        b {
            color: #ff6b6b;
            font-weight: bold;
        }
        
        i {
            color: #6bff6b;
            font-style: italic;
        }
    </style>
</head>
<body>
    <div id="TPContainer">
        <div style="text-align: center; margin-bottom: 5px; font-size: 14px;">TP remaining</div>
        <div class="tp-controls">
            <button class="tp-button" id="TPMinus">-</button>
            <div id="TPCounter">5</div>
            <button class="tp-button" id="TPPlus">+</button>
        </div>
    </div>
    <div id="TextBox"></div>
    <input type="text" id="InputField" placeholder="Type your response here...">
    
    <script>
        // Game state
        let currentPage = 1;
        let tp = 5;
        
        // Page content
        const pages = {
            1: `Welcome to the Manufactured World.
You were born into a life already planned, you are a cog in a machine too massive and protected to stop. Towering above the dead Earth are the Manufactured Towns, massive hunks of metal and concrete grids suspended in the sky, each one feels less like a town and more of an inescapable prison. The rich live above these towns in lavish fortresses you'll never get inside of. As you've been told since birth, you are there to serve the rich and nothing else. Everyone is assigned a job by the (TaskMaster), a glowing slab embedded in everyone's living quarters. You are expected to wait inside until the TaskMaster tells you what to do. [You cannot say no to the TaskMaster, unless you want the rich to dispose of you.] Inside of everyone's houses is a gas valve, when activated it sprays a deadly neurotoxin that kills whoever inhales it in seconds. It even rots living matter, so cleanup of defectors is easier. Refusing to do the assigned job, being late to the job, or failing the assigned job will make you a defector. The TaskMaster will lock your door, fill the room with gas, and the city forgets you. Before and after each job you have free time, but you know that these cold curated hours are nothing more than an illusion of freedom.

The job you have been given for the past few years of your lives is a Hunter. One of the most dangerous jobs in the system. While everyone else washes buildings, ensures programs are working correctly, or makes music to entertain the rich, your job is to descend onto the shattered remnants of the world you live on, referred to as (The Below), and retrieve whatever the TaskMaster tells you. The Below is plagued with rabid evolution and unnatural creations. The rich have played god for many years, conducting experiments without ethics, logic, or restraint. While ecosystems have mutated so much they are almost indistinguishable from what they used to be a year ago. Despite the massive danger, this is the only place where the machine can't watch or monitor you, this hostile wasteland is the only place you can breathe and see the humongous mansions the rich have built.

You've been born into a hostile world where stepping out of line is the difference between life and death. [There's no second chances, no saying no.] Don't come back empty handed.

Type "next" to continue.`
        options: {
            "next": 2,
            "continue": 2
        }
            2: "As you reminisce of what the world around you is like and what your life has been like, you wake up from your “dream” with the same stale tone you’ve woken up to for many years prior. The TaskMaster awakes, turning on the stale florescent lighting in your living quarters. The small greyscale plastic and metal room lights up and you jump to your feet, getting in front the TaskMaster as soon as you can. You know what would happen if you didn’t.

The TaskMasters screen is blank for a few moments, but after some silence, your job is displayed.
Objective(s): Descend into the wildgrass region, eliminate toxin beetle infestation
Target(s): Elder toxin beetles
Condition(s): Do not kill any egg sacks or larvae

The text lingers for a few moments before disappearing all at once. It plays a soft and hollow jingle before displaying a large 3 hour timer. It begins ticking down and your mounted map of the city highlights the drop point you need to get to before break time is over.

The TaskMaster says “Compliance window is now active. Please optimize your systems. Rest, hydrate, and refuel.” and the room returns to stillness. PLAYERS HAVE 5 TP! If they do not reach the drop point when TP hits 0, they will be killed."
            options:{
                "look around": 3,
                "continue": 4
        }
        };
        
        // Update TP display and check for kill condition
        function updateTP() {
            document.getElementById('TPCounter').textContent = tp;
            if (tp <= 0) {
                showKillPage();
            }
        }
        
        // Show the kill page
        function showKillPage() {
            document.getElementById('TextBox').innerHTML = 
                "You have failed... As you frantically make your way to the drop point, dark robed figures quickly surround you and everything fades to black. You have died.<br><br>Type \"retry\" to try again.";
        }
        
        // Format text with () as bold and [] as italic
        function formatText(text) {
            // Replace (text) with <b>text</b>
            text = text.replace(/\((.*?)\)/g, '<b>$1</b>');
            // Replace [text] with <i>text</i>
            text = text.replace(/\[(.*?)\]/g, '<i>$1</i>');
            // Replace newlines with <br> tags
            text = text.replace(/\n/g, '<br><br>');
            return text;
        }
        
        // Display a page
        function displayPage(pageNum) {
            if (pages[pageNum]) {
                let pageContent = pages[pageNum].content;
                
                // Add available commands hint
                const commands = Object.keys(pages[pageNum].options).join(", ");
                pageContent += `<br><br><i>Available commands: ${commands}</i>`;
                
                document.getElementById('TextBox').innerHTML = formatText(pageContent);
                currentPage = pageNum;
            }
        }
        
        function handleInput() {
            const input = document.getElementById('InputField').value.toLowerCase().trim();
            document.getElementById('InputField').value = '';
        
            // Handle retry first
            if (tp <= 0 && input === 'retry') {
                tp = 5;
                updateTP();
                displayPage(1);
                return;
            }
        
            // Check if input matches any option for current page
            if (pages[currentPage].options[input]) {
                const nextPage = pages[currentPage].options[input];
                displayPage(nextPage);
                
                // Optional: Add TP modifications for specific choices
                if (input === 'run') tp -= 2; // Example penalty
                updateTP();
            } else {
                // Optional: Show error for invalid input
                alert("Invalid choice! Try something else.");
            }
        }
        
        // Initialize the game
        function init() {
            updateTP();
            displayPage(1);
            
            // Set up input event listener
            document.getElementById('InputField').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    handleInput();
                }
            });
            
            // Set up TP buttons
            document.getElementById('TPPlus').addEventListener('click', function() {
                tp++;
                updateTP();
            });
            
            document.getElementById('TPMinus').addEventListener('click', function() {
                if (tp > 0) {  // Prevent going below 0 if desired
                    tp--;
                    updateTP();
                }
            });
        }
        
        // Start the game when the page loads
        window.onload = init;
    </script>
</body>
</html>
